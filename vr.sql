--
-- PostgreSQL database dump
--

-- Dumped from database version 9.6.6
-- Dumped by pg_dump version 9.6.6

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET row_security = off;

--
-- Name: plpgsql; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;


--
-- Name: EXTENSION plpgsql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';


SET search_path = public, pg_catalog;

--
-- Name: updateuserraiting(); Type: FUNCTION; Schema: public; Owner: me
--

CREATE FUNCTION updateuserraiting() RETURNS trigger
    LANGUAGE plpgsql
    AS $$ 
BEGIN 
	update users set raiting=raiting+NEW.points where id=NEW.userid;
	return NULL;
END; $$;


ALTER FUNCTION public.updateuserraiting() OWNER TO me;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- Name: games; Type: TABLE; Schema: public; Owner: me
--

CREATE TABLE games (
    id integer NOT NULL,
    date timestamp without time zone DEFAULT now() NOT NULL,
    userid integer NOT NULL,
    points integer NOT NULL,
    CONSTRAINT games_points_check CHECK ((points = ANY (ARRAY[3, 1, '-3'::integer])))
);


ALTER TABLE games OWNER TO me;

--
-- Name: games_id_seq; Type: SEQUENCE; Schema: public; Owner: me
--

CREATE SEQUENCE games_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE games_id_seq OWNER TO me;

--
-- Name: games_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: me
--

ALTER SEQUENCE games_id_seq OWNED BY games.id;


--
-- Name: games_userid_seq; Type: SEQUENCE; Schema: public; Owner: me
--

CREATE SEQUENCE games_userid_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE games_userid_seq OWNER TO me;

--
-- Name: games_userid_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: me
--

ALTER SEQUENCE games_userid_seq OWNED BY games.userid;


--
-- Name: users; Type: TABLE; Schema: public; Owner: me
--

CREATE TABLE users (
    id integer NOT NULL,
    name character varying(200),
    regdate timestamp without time zone DEFAULT now(),
    raiting integer DEFAULT 0 NOT NULL,
    CONSTRAINT users_id_check CHECK ((id >= 0))
);


ALTER TABLE users OWNER TO me;

--
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: me
--

CREATE SEQUENCE users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER TABLE users_id_seq OWNER TO me;

--
-- Name: users_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: me
--

ALTER SEQUENCE users_id_seq OWNED BY users.id;


--
-- Name: games id; Type: DEFAULT; Schema: public; Owner: me
--

ALTER TABLE ONLY games ALTER COLUMN id SET DEFAULT nextval('games_id_seq'::regclass);


--
-- Name: games userid; Type: DEFAULT; Schema: public; Owner: me
--

ALTER TABLE ONLY games ALTER COLUMN userid SET DEFAULT nextval('games_userid_seq'::regclass);


--
-- Name: users id; Type: DEFAULT; Schema: public; Owner: me
--

ALTER TABLE ONLY users ALTER COLUMN id SET DEFAULT nextval('users_id_seq'::regclass);


--
-- Data for Name: games; Type: TABLE DATA; Schema: public; Owner: me
--

COPY games (id, date, userid, points) FROM stdin;
161	2017-11-11 12:32:15.246963	1	3
162	2017-11-11 12:32:30.614561	1	-3
163	2017-11-11 12:32:47.102926	1	1
164	2017-11-11 12:33:02.894887	1	-3
165	2017-11-11 12:33:20.670832	1	3
166	2017-11-11 12:33:35.630894	1	1
167	2017-11-11 12:33:49.662797	1	-3
168	2017-11-11 12:34:06.710516	1	1
169	2017-11-11 20:12:59.975669	1	-3
170	2017-11-11 20:13:16.015794	1	-3
171	2017-11-11 20:13:33.567728	1	1
172	2017-11-11 20:13:45.503585	1	-3
173	2017-11-11 20:14:00.647526	1	1
174	2017-11-11 20:14:17.639222	1	1
175	2017-11-11 20:14:34.495444	1	3
176	2017-11-11 20:14:57.279479	1	-3
177	2017-11-11 20:15:11.591351	1	-3
178	2017-11-11 20:15:28.687364	1	3
179	2017-11-11 20:15:43.871386	1	-3
180	2017-11-11 20:15:58.367327	1	1
181	2017-11-11 20:16:13.01524	1	3
182	2017-11-11 20:16:26.807071	1	-3
183	2017-11-11 20:16:47.007156	1	-3
184	2017-11-11 20:17:02.85509	1	3
185	2017-11-11 20:17:24.415074	1	-3
186	2017-11-11 20:17:40.254995	1	-3
187	2017-11-11 20:17:59.13501	1	-3
188	2017-11-11 20:18:14.278938	1	-3
189	2017-11-11 20:18:31.014875	1	-3
190	2017-11-11 20:18:44.414869	1	1
191	2017-11-11 20:18:58.414806	1	-3
192	2017-11-11 20:19:12.822778	1	3
193	2017-11-11 20:19:29.734699	1	-3
194	2017-11-11 20:19:43.886747	1	-3
195	2017-11-11 20:19:59.678719	1	-3
196	2017-11-11 20:20:14.65466	1	-3
197	2017-11-11 20:20:31.085944	1	3
198	2017-11-11 22:41:48.416154	1	-3
199	2017-11-11 22:42:01.704548	1	-3
200	2017-11-11 22:42:15.688576	1	3
201	2017-11-11 22:42:33.512474	1	1
202	2017-11-11 22:50:00.920586	1	3
203	2017-11-11 22:50:22.040722	1	3
204	2017-11-11 22:50:41.944829	1	-3
205	2017-11-11 22:50:53.60063	1	-3
206	2017-11-11 22:51:07.200851	1	-3
207	2017-11-11 22:51:22.240289	1	1
208	2017-11-11 22:51:32.936871	1	1
209	2017-11-11 22:51:48.624173	1	1
210	2017-11-11 22:52:05.232939	1	1
211	2017-11-11 22:52:23.904985	1	3
212	2017-11-11 22:52:43.128956	1	3
213	2017-11-11 22:53:01.248973	1	-3
214	2017-11-11 22:53:15.449105	1	3
215	2017-11-11 22:53:31.497024	1	-3
216	2017-11-11 22:53:42.953038	1	3
217	2017-11-11 22:54:11.753145	1	1
218	2017-11-11 22:54:33.121235	1	1
219	2017-11-11 22:58:07.385221	1	-3
220	2017-11-11 22:58:28.249411	1	-3
221	2017-11-11 22:58:48.417433	1	-3
222	2017-11-11 22:59:07.577396	1	-3
223	2017-11-11 22:59:29.777326	1	1
224	2017-11-11 22:59:42.817478	1	3
225	2017-11-11 23:00:02.487243	1	1
226	2017-11-11 23:00:22.321452	1	1
227	2017-11-11 23:00:30.217485	1	3
228	2017-11-11 23:00:48.241173	1	-3
229	2017-11-11 23:00:59.233428	1	3
230	2017-11-11 23:01:21.82458	1	1
231	2017-11-11 23:01:35.361479	1	1
232	2017-11-11 23:01:57.065488	1	3
233	2017-11-11 23:02:14.527379	1	1
234	2017-11-11 23:02:28.81746	1	1
235	2017-11-11 23:02:45.761051	1	3
236	2017-11-11 23:03:02.401398	1	-3
237	2017-11-11 23:03:17.944853	1	-3
238	2017-11-11 23:03:30.552008	1	1
239	2017-11-11 23:03:37.545116	1	3
240	2017-11-11 23:03:58.665366	1	-3
241	2017-11-11 23:04:15.353431	1	1
242	2017-11-11 23:05:45.065418	1	1
243	2017-11-11 23:06:04.487214	1	-3
244	2017-11-11 23:06:16.560402	1	3
245	2017-11-11 23:06:35.649327	1	-3
246	2017-11-11 23:07:04.487369	1	-3
247	2017-11-11 23:07:20.369306	1	1
248	2017-11-11 23:07:46.256578	1	3
249	2017-11-11 23:08:06.241326	1	-3
250	2017-11-11 23:08:22.001467	1	-3
251	2017-11-11 23:08:28.720963	1	3
252	2017-11-11 23:08:45.185281	1	-3
253	2017-11-11 23:09:05.47341	1	1
254	2017-11-11 23:09:19.744016	1	3
255	2017-11-11 23:09:37.75336	1	-3
256	2017-11-11 23:09:54.137312	1	1
257	2017-11-11 23:10:03.625165	1	3
258	2017-11-11 23:10:22.353305	1	3
259	2017-11-11 23:10:39.585182	1	3
260	2017-11-11 23:11:08.249265	1	-3
261	2017-11-11 23:11:25.073213	1	1
262	2017-11-11 23:11:42.737343	1	-3
263	2017-11-11 23:12:16.680904	1	-3
264	2017-11-11 23:12:31.145189	1	1
265	2017-11-11 23:12:54.305181	1	-3
266	2017-11-11 23:13:09.865288	1	-3
267	2017-11-11 23:13:28.073167	1	1
268	2017-11-11 23:13:40.945184	1	3
269	2017-11-11 23:13:56.137189	1	1
270	2017-11-11 23:14:08.936713	1	-3
271	2017-11-11 23:14:22.929162	1	1
272	2017-11-11 23:14:39.337121	1	3
273	2017-11-11 23:14:53.99321	1	-3
274	2017-11-11 23:15:04.337093	1	3
275	2017-11-11 23:15:23.753065	1	3
276	2017-11-11 23:15:40.993192	1	3
277	2017-11-11 23:16:00.625085	1	-3
278	2017-11-11 23:16:15.369011	1	-3
279	2017-11-11 23:16:24.37701	1	3
280	2017-11-11 23:16:38.281287	1	1
281	2017-11-11 23:16:54.600015	1	-3
282	2017-11-11 23:17:18.912329	1	3
283	2017-11-11 23:17:34.840989	1	-3
284	2017-11-11 23:17:42.280721	1	3
285	2017-11-11 23:17:53.809033	1	3
286	2017-11-11 23:18:12.776338	1	1
287	2017-11-14 22:20:25.43536	1	3
288	2017-11-15 22:51:07.620623	1	1
289	2017-11-15 22:51:55.62169	1	1
290	2017-11-15 22:54:00.74052	1	1
291	2017-11-15 22:54:24.276429	1	-3
292	2017-11-15 22:54:36.804906	1	3
293	2017-11-15 22:54:50.188731	1	1
294	2017-11-15 22:55:06.900795	1	-3
295	2017-11-15 22:55:18.708884	1	-3
296	2017-11-15 22:55:31.580452	1	3
297	2017-11-15 22:55:42.412825	1	3
298	2017-11-15 22:56:50.092847	2	3
299	2017-11-15 23:29:14.132619	2	1
300	2017-11-15 23:29:39.699918	2	1
301	2017-11-15 23:29:58.3566	1	3
302	2017-11-15 23:30:10.772641	1	3
303	2017-11-15 23:30:27.404595	1	-3
304	2017-11-15 23:30:45.572618	1	1
305	2017-11-15 23:31:02.683919	1	1
306	2017-11-15 23:31:13.676547	1	3
307	2017-11-15 23:31:27.124533	1	-3
308	2017-11-15 23:31:44.732577	1	-3
309	2017-11-15 23:32:00.764532	1	1
310	2017-11-15 23:32:15.252631	1	1
311	2017-11-15 23:32:28.620273	1	3
312	2017-11-15 23:32:45.068419	1	-3
313	2017-11-15 23:32:53.636598	1	3
314	2017-11-15 23:33:12.372556	1	-3
315	2017-11-15 23:33:25.668552	1	1
316	2017-11-15 23:33:45.252522	1	1
317	2017-11-15 23:34:14.18053	1	3
318	2017-11-15 23:34:31.604513	1	3
319	2017-11-15 23:35:07.244517	1	1
320	2017-11-15 23:35:35.756615	1	1
321	2017-11-15 23:35:54.900508	1	-3
322	2017-11-15 23:36:38.436462	1	3
323	2017-11-15 23:38:31.868422	1	1
324	2017-11-15 23:38:51.948464	1	1
325	2017-11-15 23:39:19.828309	1	3
\.


--
-- Name: games_id_seq; Type: SEQUENCE SET; Schema: public; Owner: me
--

SELECT pg_catalog.setval('games_id_seq', 325, true);


--
-- Name: games_userid_seq; Type: SEQUENCE SET; Schema: public; Owner: me
--

SELECT pg_catalog.setval('games_userid_seq', 1, false);


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: me
--

COPY users (id, name, regdate, raiting) FROM stdin;
1	me	2017-11-03 23:51:54.411796	10
2	postgres	2017-11-04 18:58:53.671633	10
3	root	2017-11-11 00:27:43.082693	0
\.


--
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: me
--

SELECT pg_catalog.setval('users_id_seq', 3, true);


--
-- Name: games games_pkey; Type: CONSTRAINT; Schema: public; Owner: me
--

ALTER TABLE ONLY games
    ADD CONSTRAINT games_pkey PRIMARY KEY (id);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: me
--

ALTER TABLE ONLY users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: games uprainting; Type: TRIGGER; Schema: public; Owner: me
--

CREATE TRIGGER uprainting AFTER INSERT ON games FOR EACH ROW EXECUTE PROCEDURE updateuserraiting();


--
-- Name: games games_userid_fkey; Type: FK CONSTRAINT; Schema: public; Owner: me
--

ALTER TABLE ONLY games
    ADD CONSTRAINT games_userid_fkey FOREIGN KEY (userid) REFERENCES users(id);


--
-- PostgreSQL database dump complete
--

